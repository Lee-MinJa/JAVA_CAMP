<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.member">
	 <select id="memberList" parameterType="map" resultType="map">
SELECT MEM_NUM, MEM_CODE, MEM_ID, 
        MEM_PW, MEM_NICK, MEM_NAME,
        MEM_EMAIL, MEM_BIZNUM, MEM_BIZNAME,
        MEM_TEL, MEM_JOIN FROM member
<if test="MEM_ID !=null and MEM_PW !=null">
WHERE MEM_ID = #{MEM_ID}
AND MEM_PW = #{MEM_PW}
</if>
 </select>
 <select id="proc_login2022" parameterType="map" statementType="CALLABLE">
		{ call proc_login2022(#{mem_id, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String}
							,#{mem_pw, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String}
							,#{mem_name, mode=OUT, jdbcType=VARCHAR, javaType=java.lang.String}
		)}
	</select>
 	<insert id="memberInsert" parameterType="map">
insert into member_security(mem_id,password, username, role)
values(#{mem_id},#{password},#{username},#{role})
	</insert> 
	
	<select id="memberList" parameterType="map" resultType="map">
		SELECT
				mem_id, mem_pw, mem_name,
				mem_email, mem_num, '쪽지쓰기' memo
		FROM member
	</select>
	<select id="findByUsername" parameterType="string" resultType="com.example.demo.vo.MemberVO">
		SELECT mem_id, username, password
		FROM member_security
		WHERE username = #{value}
	</select>
	<select id="loginAction" parameterType="map" resultType="map">
SELECT NVL((
    		SELECT
			 mem_name		
		FROM member
		WHERE mem_id = #{mem_id}
		AND mem_pw = #{mem_pw}
            ),'비밀번호가 틀립니다.') mem_name
        FROM dual
	</select>
 
</mapper>